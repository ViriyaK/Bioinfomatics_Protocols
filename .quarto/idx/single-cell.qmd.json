{"title":"Single-Cell Analysis","markdown":{"yaml":{"execute":{"eval":false},"format":{"html":{"link-external-newwindow":true}}},"headingText":"Single-Cell Analysis","containsRefs":false,"markdown":"\n\n\nMost of these code are reliant on Seurat. You may now and then have to use scanpy in python, or revert to the SingleCellExperiment object utilized in scater.\n\n## Useful links and resources\n\nFine-tuning UMAP visualizations <https://jlmelville.github.io/uwot/abparams.html>\\\nTSNE animation <https://distill.pub/2016/misread-tsne/>\\\nSimple explanantion on TSNE <https://www.cancer.gov/about-nci/organization/ccg/blog/2020/interview-t-sne>\\\nDifferent integration methods <https://swaruplab.bio.uci.edu/tutorial/integration/integration_tutorial.html>\\\nIllustration of how UMAPs can be misleading <https://pair-code.github.io/understanding-umap/> <https://blog.bioturing.com/2022/01/14/umap-vs-t-sne-single-cell-rna-seq-data-visualization/>\n\nSingle cell best practices from the Theis lab <https://www.sc-best-practices.org/preamble.html> <https://broadinstitute.github.io/2019_scWorkshop/index.html>\n\nDeep explanation of Seurat's AddModuleScore function <https://www.waltermuskovic.com/2021/04/15/seurat-s-addmodulescore-function/>\n\n### Psudotime analysis\n\n<https://broadinstitute.github.io/2019_scWorkshop/functional-pseudotime-analysis.html>\\\nList of single cell pseudotime packages publishe#d <https://github.com/agitter/single-cell-pseudotime>\n\n### Spatial Transciptomics\n\n<https://scimap.xyz/tutorials/md/spatial_biology_scimap/>\n\n### Downloading data\n\nbam files uploaded to SRA will be missing certain 10x flags and will not work. You need to get the original bam files via SRA Data Access Tab and downloaded via wget and run bamtofastq.\\\nfor 10x, need to use --split-filles and --include-technical.\n\n### CellRanger\n\n## Seurat\n\n### Integration\n\n-   applying sctransform to each sample in the list\n-   selecting integration features,\n-   finding integration anchors,\n-   integrate data at this point, DefaultAssay is integrated, and there is an associated VariableFeatures, which really is output of SelectIntegrationFetures. rownames(integrated\\[\\[\"SCT\"\\]\\]@scale.data) is the same as SelectIntegration Features again.\\\n    https://github.com/satijalab/seurat/issues/6185 explanation of the different variable gene options from sct integrated models\n\nAfter `merge()` variable features that have been calculated by SCTransform is reset.\n\n### Plotting\n\nUse [scCustomize](https://samuel-marsh.github.io/scCustomize/index.html) for improved plotting over Seurat's defaults.\n\nTo plot heatmaps with extra metadata information, use the [scillius](https://scillus.netlify.app/) package.\n\nTo get statistics on differential gene levels, use the package `ggbetweenstats` from [ggstatsplot](https://indrajeetpatil.github.io/ggstatsplot/index.html).\n\n```{r}\ncell_expression <- rna_integrated@assays$RNA@data[c(\"MIPOL1\", \"ETV1\", \"DGKB\", \"FOXA2\", \"AR\", \"SYP\"),] %>% as.matrix() %>% t()\nmeta_data <- rna_integrated@meta.data\nplot_data <- cbind(meta_data, cell_expression)\nsaveRDS(plot_data, \"scRNAseq_violin.RDS\")\n```\n\n### Utility functions\n\nRenaming all identities\n\n```{r}\ncell_types <- c(\"0\" = \"\", \"1\" = \"\", \"2\" = \"\", \"3\" = \"\", \"4\" = \"\", \"5\" = \"\", \"6\" = \"\")\nIdents(merged) <- \"SCT_snn_res.0.2\"\nmerged <- RenameIdents(merged, cell_types)\nmerged$status <- Idents(merged)\nDimPlot_scCustom(integrated, group.by = \"cell_types\", colors_use = polychrome_pal)\nmerged$status <- factor(merged$status, \n                        levels = c(\"\")) # useful for rearranging levels\nIdents(merged) <- \"status\"\n```\n\nRenaming a few identities\n\n```{r}\nnew_groups <- case_when(seu_obj$clust == \"a\" ~ \"Tumor\",\n          .default = seu_obj$clust) %>% as.factor()\nnames(new_groups) <- names(seu_obj$clust)\nseu_obj$new_groups <- new_groups\nseu_obj$new_groups <- factor(seu_obj$new_groups, \n                        levels = c(\"\")) # have to do this again\n```\n\nAdding new clusters, cluster 13 was not present previously\n\n```{r}\nseu_obj$manual_clusters <- seu_obj$integrated_snn_res.0.6\nlevels(seu_obj$manual_clusters) <- c(levels(seu_obj$manual_clusters), \"13\")\nseu_obj$manual_clusters[names(seu_obj$manual_clusters) %in% select_cells] <- \"13\"\n```\n","srcMarkdownNoYaml":"\n\n# Single-Cell Analysis\n\nMost of these code are reliant on Seurat. You may now and then have to use scanpy in python, or revert to the SingleCellExperiment object utilized in scater.\n\n## Useful links and resources\n\nFine-tuning UMAP visualizations <https://jlmelville.github.io/uwot/abparams.html>\\\nTSNE animation <https://distill.pub/2016/misread-tsne/>\\\nSimple explanantion on TSNE <https://www.cancer.gov/about-nci/organization/ccg/blog/2020/interview-t-sne>\\\nDifferent integration methods <https://swaruplab.bio.uci.edu/tutorial/integration/integration_tutorial.html>\\\nIllustration of how UMAPs can be misleading <https://pair-code.github.io/understanding-umap/> <https://blog.bioturing.com/2022/01/14/umap-vs-t-sne-single-cell-rna-seq-data-visualization/>\n\nSingle cell best practices from the Theis lab <https://www.sc-best-practices.org/preamble.html> <https://broadinstitute.github.io/2019_scWorkshop/index.html>\n\nDeep explanation of Seurat's AddModuleScore function <https://www.waltermuskovic.com/2021/04/15/seurat-s-addmodulescore-function/>\n\n### Psudotime analysis\n\n<https://broadinstitute.github.io/2019_scWorkshop/functional-pseudotime-analysis.html>\\\nList of single cell pseudotime packages publishe#d <https://github.com/agitter/single-cell-pseudotime>\n\n### Spatial Transciptomics\n\n<https://scimap.xyz/tutorials/md/spatial_biology_scimap/>\n\n### Downloading data\n\nbam files uploaded to SRA will be missing certain 10x flags and will not work. You need to get the original bam files via SRA Data Access Tab and downloaded via wget and run bamtofastq.\\\nfor 10x, need to use --split-filles and --include-technical.\n\n### CellRanger\n\n## Seurat\n\n### Integration\n\n-   applying sctransform to each sample in the list\n-   selecting integration features,\n-   finding integration anchors,\n-   integrate data at this point, DefaultAssay is integrated, and there is an associated VariableFeatures, which really is output of SelectIntegrationFetures. rownames(integrated\\[\\[\"SCT\"\\]\\]@scale.data) is the same as SelectIntegration Features again.\\\n    https://github.com/satijalab/seurat/issues/6185 explanation of the different variable gene options from sct integrated models\n\nAfter `merge()` variable features that have been calculated by SCTransform is reset.\n\n### Plotting\n\nUse [scCustomize](https://samuel-marsh.github.io/scCustomize/index.html) for improved plotting over Seurat's defaults.\n\nTo plot heatmaps with extra metadata information, use the [scillius](https://scillus.netlify.app/) package.\n\nTo get statistics on differential gene levels, use the package `ggbetweenstats` from [ggstatsplot](https://indrajeetpatil.github.io/ggstatsplot/index.html).\n\n```{r}\ncell_expression <- rna_integrated@assays$RNA@data[c(\"MIPOL1\", \"ETV1\", \"DGKB\", \"FOXA2\", \"AR\", \"SYP\"),] %>% as.matrix() %>% t()\nmeta_data <- rna_integrated@meta.data\nplot_data <- cbind(meta_data, cell_expression)\nsaveRDS(plot_data, \"scRNAseq_violin.RDS\")\n```\n\n### Utility functions\n\nRenaming all identities\n\n```{r}\ncell_types <- c(\"0\" = \"\", \"1\" = \"\", \"2\" = \"\", \"3\" = \"\", \"4\" = \"\", \"5\" = \"\", \"6\" = \"\")\nIdents(merged) <- \"SCT_snn_res.0.2\"\nmerged <- RenameIdents(merged, cell_types)\nmerged$status <- Idents(merged)\nDimPlot_scCustom(integrated, group.by = \"cell_types\", colors_use = polychrome_pal)\nmerged$status <- factor(merged$status, \n                        levels = c(\"\")) # useful for rearranging levels\nIdents(merged) <- \"status\"\n```\n\nRenaming a few identities\n\n```{r}\nnew_groups <- case_when(seu_obj$clust == \"a\" ~ \"Tumor\",\n          .default = seu_obj$clust) %>% as.factor()\nnames(new_groups) <- names(seu_obj$clust)\nseu_obj$new_groups <- new_groups\nseu_obj$new_groups <- factor(seu_obj$new_groups, \n                        levels = c(\"\")) # have to do this again\n```\n\nAdding new clusters, cluster 13 was not present previously\n\n```{r}\nseu_obj$manual_clusters <- seu_obj$integrated_snn_res.0.6\nlevels(seu_obj$manual_clusters) <- c(levels(seu_obj$manual_clusters), \"13\")\nseu_obj$manual_clusters[names(seu_obj$manual_clusters) %in% select_cells] <- \"13\"\n```\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":false,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":true,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":true,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"single-cell.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.450","bibliography":["references.bib"],"editor":"visual","theme":"cosmo","code-copy":true},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":false,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","output-file":"single-cell.pdf"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"block-headings":true,"bibliography":["references.bib"],"editor":"visual","documentclass":"scrreprt"},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf"]}